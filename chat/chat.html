<html>
  <head>
    <title>Host</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />
  </head>
  <body class="container">
    <h1>Rum: {{name}}</h1>
    <hr />
    <div id="log"></div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="/linda/linda.js"></script>
    <script src="/jquery/jquery.js"></script>
    <script>
      var server_url = "http://localhost:3000";
      var socket = io.connect(server_url);
      var linda = new Linda().connect(socket);
      var ts = linda.tuplespace(name);

      var rooms = linda.tuplespace('chatrooms');

      var print = function (msg) {
        $("#log").prepend( '<p>'+msg+'</p><hr />' );
      };
      
      var read = function () {
        ts.read({type: "msg"}, function(err, tuple) {
          console.log(tuple.data.msg);
          print(tuple.data.from + "> " + tuple.data.msg);
        });
      }

      linda.io.on("connect", function(){
        ts.watch({type: "msg"}, function(err, tuple){
          print(tuple.data.from + "> " + tuple.data.msg);
        });
      });
    </script>
  </body>
</html>
